---
problemLabel: E
problemName: 暴氣
problemId: BaoQi
---

#

排隊的時候，如果隊伍過長或是排隊時間太久，脾氣不好的人就容易爆氣。  
本題要求你模擬會有人爆氣的排隊情況。  

現在隊伍中有 $N$ 個人在排隊，每個人依次編號且都有一個爆氣值 $A_i$。  

隊伍中可能會有「連續的」好幾個小圈圈（認識的朋友或是現場發現聊得開）。  
有時小圈圈可能會分裂（排隊不耐煩所以吵架之類的）。  
有人想爆氣時，他的小圈圈會一起爆氣，而他們的沒水準值就是小圈圈中最大的爆氣值。  

一開始隊伍中所有人都在同一個小圈圈。  
有 $Q$ 筆事件需要模擬，事件有四種類型：  
1. divide p：第 $p$ 人與第 $p+1$ 人吵架，小圈圈以他們為界分成兩個連續的小圈圈  
（保證兩人原本在同個小圈圈）  
2. merge p：將第 $p$ 人與第 $p+1$ 人所在的兩個小圈圈合成一個小圈圈  
（保證兩人原本不在同個小圈圈）  
3. change idx v：第 $idx$ 人的爆氣值 $A_{idx}$ 更改為 $v$  
4. baoqi l r：第 $l$ 人到第 $r$ 人的各個小圈圈一起爆氣，輸出這些小圈圈沒水準值的總和  
（保證 $l=1$ 或第 $l-1$ 人與第 $l$ 人不在同個小圈圈）  
（保證 $r=N$ 或第 $r+1$ 人與第 $r$ 人不在同個小圈圈）  
（各小圈圈的沒水準值只需考慮一次）  

\clearpage

## 輸入
第一行有兩個整數$N,Q$，表示人數與事件數量。  
第二行有 $N$ 個整數，$A_1,A_2,A_3...A_N$ 表示每個人的爆氣值。  
接下來有 $Q$ 行，每行一開始有個整數 $t$，表示該操作的類型：  
如果 $t=1$，接下來會有一個整數 $p$，表示第 $p$ 人與第 $p+1$ 人吵架；  
如果 $t=2$，接下來會有一個整數 $p$，表示第 $p$ 人與第 $p+1$ 人的小圈圈合為一個；  
如果 $t=3$，接下來會有兩個整數 $idx$ 和 $v$，表示第 $idx$人的爆氣值$A_{idx}$更改為$v$；  
如果 $t=4$，接下來會有兩個整數 $l$ 和 $r$，表示 $l$ 到 $r$ 的人一起爆氣。  

## 輸出
對於有人爆氣時，輸出一個整數，表示那些小圈圈沒水準值的總和。  

## 輸入限制
 - $1 \leq N,Q \leq 10^5$
 - $1 \leq Ai,v \leq 10^9$
 - $1 \leq t \leq 4$
 - $1 \leq p < N$
 - $1 \leq idx \leq N$
 - $1 \leq l \leq r \leq N$

## 子任務
| 編號 | 分數 |    限制    |
| --- | --- | ---------- |
|  1  | 20 | $1 \leq N,Q \leq 100$ |
|  2  | 7 | 爆氣次數（$t=4$ 的事件數量） $\leq 100$ |
|  3  | 13 | 所有人爆氣值恆相同 |
|  4  | 60 | 無額外限制 |

\clearpage

## 範例輸入
```
5 11
1 2 3 4 5
4 1 5
3 3 6
4 1 5
1 2
4 1 2
4 1 5
1 3
4 1 5
4 3 3
2 2
4 1 5
```

## 範例輸出
```
5
6
2
8
13
6
11
```

## 範例解釋
| 事件 | 隊伍 |    說明    |
| --- | --- | ---------- |
|  1  | [1,2,3,4,5] | $1$ 到 $5$ 只有一個小圈圈，沒水準值 $=5$ |
|  2  | [1,2,6,4,5] | 第 $3$ 人爆氣值變為 $6$ |
|  3  | [1,2,6,4,5] | $1$ 到 $5$ 只有一個小圈圈，沒水準值 $=6$ |
|  4  | [1,2],[6,4,5] | 第 $2$ 人與第 $3$ 人吵架，小圈圈分裂 |
|  5  | [1,2],[6,4,5] | $1$ 到 $2$ 只有一個小圈圈，沒水準值 $=2$ |
|  6  | [1,2],[6,4,5] | $1$ 到 $5$ 有兩個小圈圈，沒水準值 $=2+6=8$ |
|  7  | [1,2],[6],[4,5] | 第 $3$ 人與第 $4$ 人吵架，小圈圈分裂 |
|  8  | [1,2],[6],[4,5] | $1$ 到 $5$ 有三個小圈圈，沒水準值 $=2+6+5=13$ |
|  9  | [1,2],[6],[4,5] | $3$ 到 $3$ 只有一個小圈圈，沒水準值 $=6$ |
|  10  | [1,2,6],[4,5] | 第 $2$ 人與第 $3$ 人交好，小圈圈合併 |
|  11  | [1,2,6],[4,5] | $1$ 到 $5$ 有兩個小圈圈，沒水準值 $=6+5=11$ |
